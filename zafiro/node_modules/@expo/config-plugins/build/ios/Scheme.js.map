<<<<<<< HEAD
{"version":3,"file":"Scheme.js","names":["_iosPlugins","data","require","withScheme","createInfoPlistPluginWithPropertyGuard","setScheme","infoPlistProperty","expoConfigProperty","exports","getScheme","config","Array","isArray","scheme","validate","value","filter","infoPlist","_config$ios","_config$ios2","ios","bundleIdentifier","push","length","CFBundleURLTypes","CFBundleURLSchemes","appendScheme","_infoPlist$CFBundleUR","existingSchemes","some","includes","removeScheme","map","bundleUrlType","index","indexOf","splice","undefined","Boolean","hasScheme","schemes","getSchemesFromPlist","reduce"],"sources":["../../src/ios/Scheme.ts"],"sourcesContent":["import { ExpoConfig } from '@expo/config-types';\n\nimport { createInfoPlistPluginWithPropertyGuard } from '../plugins/ios-plugins';\nimport { InfoPlist, URLScheme } from './IosConfig.types';\n\nexport const withScheme = createInfoPlistPluginWithPropertyGuard(\n  setScheme,\n  {\n    infoPlistProperty: 'CFBundleURLTypes',\n    expoConfigProperty: 'scheme',\n  },\n  'withScheme'\n);\n\nexport function getScheme(config: { scheme?: string | string[] }): string[] {\n  if (Array.isArray(config.scheme)) {\n    const validate = (value: any): value is string => {\n      return typeof value === 'string';\n    };\n    return config.scheme.filter<string>(validate);\n  } else if (typeof config.scheme === 'string') {\n    return [config.scheme];\n  }\n  return [];\n}\n\nexport function setScheme(\n  config: Partial<Pick<ExpoConfig, 'scheme' | 'ios'>>,\n  infoPlist: InfoPlist\n): InfoPlist {\n  const scheme = [\n    ...getScheme(config),\n    // @ts-ignore: TODO: ios.scheme is an unreleased -- harder to add to turtle v1.\n    ...getScheme(config.ios ?? {}),\n  ];\n  // Add the bundle identifier to the list of schemes for easier Google auth and parity with Turtle v1.\n  if (config.ios?.bundleIdentifier) {\n    scheme.push(config.ios.bundleIdentifier);\n  }\n  if (scheme.length === 0) {\n    return infoPlist;\n  }\n\n  return {\n    ...infoPlist,\n    CFBundleURLTypes: [{ CFBundleURLSchemes: scheme }],\n  };\n}\n\nexport function appendScheme(scheme: string | null, infoPlist: InfoPlist): InfoPlist {\n  if (!scheme) {\n    return infoPlist;\n  }\n\n  const existingSchemes = infoPlist.CFBundleURLTypes ?? [];\n  if (existingSchemes?.some(({ CFBundleURLSchemes }) => CFBundleURLSchemes.includes(scheme))) {\n    return infoPlist;\n  }\n\n  return {\n    ...infoPlist,\n    CFBundleURLTypes: [\n      ...existingSchemes,\n      {\n        CFBundleURLSchemes: [scheme],\n      },\n    ],\n  };\n}\n\nexport function removeScheme(scheme: string | null, infoPlist: InfoPlist): InfoPlist {\n  if (!scheme) {\n    return infoPlist;\n  }\n\n  // No need to remove if we don't have any\n  if (!infoPlist.CFBundleURLTypes) {\n    return infoPlist;\n  }\n\n  infoPlist.CFBundleURLTypes = infoPlist.CFBundleURLTypes.map((bundleUrlType) => {\n    const index = bundleUrlType.CFBundleURLSchemes.indexOf(scheme);\n    if (index > -1) {\n      bundleUrlType.CFBundleURLSchemes.splice(index, 1);\n      if (bundleUrlType.CFBundleURLSchemes.length === 0) {\n        return undefined;\n      }\n    }\n    return bundleUrlType;\n  }).filter(Boolean) as URLScheme[];\n\n  return infoPlist;\n}\n\nexport function hasScheme(scheme: string, infoPlist: InfoPlist): boolean {\n  const existingSchemes = infoPlist.CFBundleURLTypes;\n\n  if (!Array.isArray(existingSchemes)) return false;\n\n  return existingSchemes?.some(({ CFBundleURLSchemes: schemes }: any) =>\n    Array.isArray(schemes) ? schemes.includes(scheme) : false\n  );\n}\n\nexport function getSchemesFromPlist(infoPlist: InfoPlist): string[] {\n  if (Array.isArray(infoPlist.CFBundleURLTypes)) {\n    return infoPlist.CFBundleURLTypes.reduce<string[]>((schemes, { CFBundleURLSchemes }) => {\n      if (Array.isArray(CFBundleURLSchemes)) {\n        return [...schemes, ...CFBundleURLSchemes];\n      }\n      return schemes;\n    }, []);\n  }\n  return [];\n}\n"],"mappings":"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"}
=======
{"version":3,"sources":["../../src/ios/Scheme.ts"],"names":["withScheme","setScheme","getScheme","config","Array","isArray","scheme","validate","value","filter","infoPlist","ios","bundleIdentifier","push","length","CFBundleURLTypes","CFBundleURLSchemes","appendScheme","existingSchemes","removeScheme","map","bundleUrlType","index","indexOf","splice","undefined","Boolean","hasScheme","some","schemes","includes","getSchemesFromPlist","reduce"],"mappings":"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","sourcesContent":["import { ExpoConfig } from '@expo/config-types';\n\nimport { createInfoPlistPlugin } from '../plugins/ios-plugins';\nimport { InfoPlist, URLScheme } from './IosConfig.types';\n\nexport const withScheme = createInfoPlistPlugin(setScheme, 'withScheme');\n\nexport function getScheme(config: { scheme?: string | string[] }): string[] {\n  if (Array.isArray(config.scheme)) {\n    const validate = (value: any): value is string => {\n      return typeof value === 'string';\n    };\n    return config.scheme.filter<string>(validate);\n  } else if (typeof config.scheme === 'string') {\n    return [config.scheme];\n  }\n  return [];\n}\n\nexport function setScheme(\n  config: Partial<Pick<ExpoConfig, 'scheme' | 'ios'>>,\n  infoPlist: InfoPlist\n): InfoPlist {\n  const scheme = [\n    ...getScheme(config),\n    // @ts-ignore: TODO: ios.scheme is an unreleased -- harder to add to turtle v1.\n    ...getScheme(config.ios ?? {}),\n  ];\n  // Add the bundle identifier to the list of schemes for easier Google auth and parity with Turtle v1.\n  if (config.ios?.bundleIdentifier) {\n    scheme.push(config.ios.bundleIdentifier);\n  }\n  if (scheme.length === 0) {\n    return infoPlist;\n  }\n\n  return {\n    ...infoPlist,\n    CFBundleURLTypes: [{ CFBundleURLSchemes: scheme }],\n  };\n}\n\n// TODO: update this to be idempotent!\nexport function appendScheme(scheme: string | null, infoPlist: InfoPlist): InfoPlist {\n  if (!scheme) {\n    return infoPlist;\n  }\n\n  const existingSchemes = infoPlist.CFBundleURLTypes;\n\n  return {\n    ...infoPlist,\n    CFBundleURLTypes: [\n      ...(existingSchemes ?? []),\n      {\n        CFBundleURLSchemes: [scheme],\n      },\n    ],\n  };\n}\n\nexport function removeScheme(scheme: string | null, infoPlist: InfoPlist): InfoPlist {\n  if (!scheme) {\n    return infoPlist;\n  }\n\n  // No need to remove if we don't have any\n  if (!infoPlist.CFBundleURLTypes) {\n    return infoPlist;\n  }\n\n  infoPlist.CFBundleURLTypes = infoPlist.CFBundleURLTypes.map(bundleUrlType => {\n    const index = bundleUrlType.CFBundleURLSchemes.indexOf(scheme);\n    if (index > -1) {\n      bundleUrlType.CFBundleURLSchemes.splice(index, 1);\n      if (bundleUrlType.CFBundleURLSchemes.length === 0) {\n        return undefined;\n      }\n    }\n    return bundleUrlType;\n  }).filter(Boolean) as URLScheme[];\n\n  return infoPlist;\n}\n\nexport function hasScheme(scheme: string, infoPlist: InfoPlist): boolean {\n  const existingSchemes = infoPlist.CFBundleURLTypes;\n\n  if (!Array.isArray(existingSchemes)) return false;\n\n  return existingSchemes.some(({ CFBundleURLSchemes: schemes }: any) => schemes.includes(scheme));\n}\n\nexport function getSchemesFromPlist(infoPlist: InfoPlist): string[] {\n  if (Array.isArray(infoPlist.CFBundleURLTypes)) {\n    return infoPlist.CFBundleURLTypes.reduce<string[]>((schemes, { CFBundleURLSchemes }) => {\n      if (Array.isArray(CFBundleURLSchemes)) {\n        return [...schemes, ...CFBundleURLSchemes];\n      }\n      return schemes;\n    }, []);\n  }\n  return [];\n}\n"],"file":"Scheme.js"}
>>>>>>> apetey
